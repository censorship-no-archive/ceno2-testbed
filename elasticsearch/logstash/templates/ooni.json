{
  "order": 0,
  "template": "ooni",
  "settings": {
    "index.number_of_replicas": 0,
    "index.number_of_shards": 1
  },
  "mappings": {
    "http_reachability_test": {
      "properties": {
        "data_format_version": { "type": "keyword" },
        "report_id": { "type": "keyword" },
        "probe_city": { "type": "keyword" },
        "probe_cc": { "type": "keyword" },
        "probe_ip": { "type": "ip" },
        "test_version": { "type": "keyword" },
        "probe_asn": { "type": "keyword" },
        "@timestamp": { "type": "date", "format": "date_optional_time" },
        "test_runtime": { "type": "float" },
        "failure": { "type": "keyword" },
        "request_method": { "type": "keyword" },
        "request_url": { "type": "keyword" },
        "response_body": { "type": "text" },
        "response_code": { "type": "short" },
        "response_header_date": { "type": "date" },
        "response_header_content-type": { "type": "keyword" },
        "response_header_server": { "type": "keyword" },
        "attempt": { "type": "short" },
        "http_success": { "type": "boolean" },
        "http_response_time": { "type": "float" },
        "peer_nat": { "type": "boolean" },
        "@version": { "type": "short" },
        "software_version": { "type": "keyword" },
        "software_name": { "type": "keyword" }
      }
    },
    "nat_detection_test": {
      "properties": {
        "remotes": { "type": "keyword" },
        "alt_remotes": { "type": "keyword" },
        "count": { "type": "short" },
        "data": { "type": "text" },
        "hash": { "type": "keyword" },
        "length": { "type": "integer" },
        "local_ip": { "type": "ip" },
        "local_port": { "type": "integer" },
        "max_send": { "type": "short" },
        "nat_type": { "type": "keyword" },
        "remote_ip": { "type": "ip" },
        "remote_port": { "type": "integer" },
        "send_interval": { "type": "short" },
        "test_id": { "type": "keyword" },
        "time_last": { "type": "date", "format": "date_optional_time" },
        "data_format_version": { "type": "keyword" },
        "report_id": { "type": "keyword" },
        "probe_city": { "type": "keyword" },
        "probe_cc": { "type": "keyword" },
        "probe_ip": { "type": "ip" },
        "test_version": { "type": "keyword" },
        "probe_asn": { "type": "keyword" },
        "@timestamp": { "type": "date", "format": "date_optional_time" },
        "test_runtime": { "type": "float" },
        "@version": { "type": "short" },
        "software_version": { "type": "keyword" },
        "software_name": { "type": "keyword" },
        "upnp_active": { "type": "boolean" }
      },
      "p2p_bittorrent_test": {
        "bytes_received": { "type": "long" },
        "bytes_sent": { "type": "long" },
        "command_exit_reason": { "type": "keyword" },
        "command_name": { "type": "keyword" },
        "command_stderr": { "type": "text" },
        "encrypted": { "type": "boolean" },
        "event_type": { "type": "keyword" },
        "rpc_type": { "type": "keyword" },
        "peer_address": { "type": "ip" },
        "peer_port": { "type": "integer" },
        "reason_error": { "type": "boolean" },
        "my_id": { "type": "keyword" },
        "peer_id": { "type": "keyword" },
        "incoming": { "type": "boolean" },
        "ledbat": { "type": "boolean" },
        "data_format_version": { "type": "keyword" },
        "report_id": { "type": "keyword" },
        "probe_city": { "type": "keyword" },
        "probe_cc": { "type": "keyword" },
        "probe_ip": { "type": "ip" },
        "test_version": { "type": "keyword" },
        "probe_asn": { "type": "keyword" },
        "@timestamp": { "type": "date", "format": "date_optional_time" },
        "test_runtime": { "type": "float" },
        "@version": { "type": "short" },
        "software_version": { "type": "keyword" },
        "software_name": { "type": "keyword" }
       }
    }
  }
}
